{% extends "base.html" %}
{% block title %}Home Page{% endblock %}
{% block content %}

<style>
    .container {
      text-align: center;
    }
    .upload-container {
      display: none;
    }

    
    
</style>
<h1>American Sign Language Detection</h1>
<img src="static/Cover.JPEG" alt="Different Signs of American Sign Language" width="400" height="300" style="margin-top: 20px;" >
<p style="margin-top: 60px;">Please choose between recording a video online or uploading a video</p>
<p>In both cases the video should be a maximum of 1 second</p>
<a href="/Record"><button class="btn btn-primary" style="margin-left: 100px;">Record Video</button></a>
<button class="btn btn-primary" onclick="toggleUpload()">Upload Video</button>

<div class="upload-container">
  <input type="file" id="video" accept="video/mp4" />
  <button class="btn btn-primary" onclick="uploadVideo()">Upload</button>
</div>
<script>
function toggleUpload() {
  var uploadContainer = document.querySelector('.upload-container');
  if (uploadContainer.style.display === "none") {
    uploadContainer.style.display = "block";
  } else {
    uploadContainer.style.display = "none";
  }

}


function uploadVideo() {
  // Get the input element
  var input = document.getElementById("video");

  // Check if a file has been selected
  if (input.files.length > 0) {
    // Get the first file
    var file = input.files[0];

    // Check if the file is an MP4 video
    if (file.type === "video/mp4") {
      // Create a video element
      var video = document.createElement('video');

      // Set the video source to the file object
      video.src = URL.createObjectURL(file);

      // Wait for the video to load metadata
      video.onloadedmetadata = function() {
        // Check if the video is less than or equal to 1 second in length
        if (video.duration <= 3) {
          // Create a FormData object
          var formData = new FormData();

          // Add the video file to the form data
          formData.append("video", file);

          // Send the form data to the server using a POST method
          var xhr = new XMLHttpRequest();
          xhr.open("POST", "/");
          xhr.send(formData);

                  // Hide the upload container
        var uploadContainer = document.querySelector('.upload-container');
        uploadContainer.style.display = "none"; 
        } else {
          alert("The video must be 2 second or less in length.");
        }
      };
    } else {
      alert("The file must be an MP4 video.");
    }
  }
}
</script>
{% endblock %}
